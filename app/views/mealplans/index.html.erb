<script src="https://code.highcharts.com/highcharts.js"></script>
<script src="https://code.highcharts.com/modules/data.js"></script>
<script src="https://code.highcharts.com/modules/exporting.js"></script>
<script src="https://code.highcharts.com/modules/export-data.js"></script>



<%if @current_user.nil?%>

<h2>Please <%= link_to 'Sign in', login_path %></h2>

<% elsif @current_user.present?%>

<p id="notice"><%= notice %></p>

<h1>Mealplans</h1>
<div id="calendar">
</div>
<table id="mealplans">
  <thead>
    <% @servingguide.each do |servingguide| %>
        <tr>
          <td colspan = "2">Veg</td>
          <td colspan = "2">Fruit</td>
          <td colspan = "2">Grain</td>
          <td colspan = "2">Meat</td>
          <td colspan = "2">Milk</td>
          <td colspan = "2">AddlServe</td>
        </tr>
        <tr>
          <td></td>
        </tr>
        <tr>
          <td colspan = "2"><%= servingguide.veg %></td>
          <td id="Fruit" colspan = "2"><%= servingguide.fruit %></td>
          <td id="Grain" colspan = "2"><%= servingguide.grain %></td>
          <td id="Meat" colspan = "2"><%= servingguide.meat %></td>
          <td id="Milk" colspan = "2"><%= servingguide.milk %></td>
          <td id="AddlServe" colspan = "2"><%= servingguide.additional_serve %></td>
        </tr>
      <% end %>
        <tr>
          <th>User</th>
          <th>Date</th>
          <th>Mealtype</th>
          <th>Veg</th>
          <th>Fruit</th>
          <th>Grain</th>
          <th>Meat</th>
          <th>Milk</th>
          <th>Additional serve</th>
          <th colspan="3"></th>
        </tr>
    </thead>
    <tbody>
      <% @mealplans.each do |mealplan| %>
        <tr class="date-<%= mealplan.date %>">
          <td><%= mealplan.user_id %></td>
          <td><%= mealplan.date %></td>
          <td><%= mealplan.mealtype %></td>
          <td id="Veg"><%= mealplan.veg %></td>
          <td><%= mealplan.fruit %></td>
          <td><%= mealplan.grain %></td>
          <td><%= mealplan.meat %></td>
          <td><%= mealplan.milk %></td>
          <td><%= mealplan.additional_serve %></td>
          <td><%= link_to 'View Graph', mealplanshowbydate_path(mealplan.date)%></td>
  <!--
          <td><%= link_to 'Edit', edit_mealplan_path(mealplan) %></td>
          <td><%= link_to 'Destroy', mealplan, method: :delete, data: { confirm: 'Are you sure?' } %></td>
        </tr> -->
      <% end %>

    </tbody>
</table>




<!-- <table id="mealchart">
  <thead>

         <tr>
             <th></th>
             <th>Recommended</th>
             <th>Eaten</th>
         </tr>
     </thead>
     <tbody>
         <tr>
             <th>Vegetables</th>
             <td id = "ServingVeg"><%= @servingguide.first.veg %></td>
             <td id = "GraphVeg"><%= @mealplans.sum(:veg) %></td>
         </tr>
         <tr>
             <th>Fruit</th>
             <td><%= @servingguide.first.fruit %></td>
             <td id = "GraphFruit"><%= @mealplans.sum(:fruit) %></td>
         </tr>
         <tr>
             <th>Grain</th>
             <td><%= @servingguide.first.grain %></td>
             <td id = "GraphGrain"><%= @mealplans.sum(:grain) %></td>
         </tr>
         <tr>
             <th>Meat</th>
             <td><%= @servingguide.first.meat %></td>
             <td id = "GraphMeat"><%= @mealplans.sum(:meat) %></td>
         </tr>
         <tr>
             <th>Milk</th>
             <td><%= @servingguide.first.milk %></td>
             <td id = "GraphMilk"><%= @mealplans.sum(:milk) %></td>
         </tr>
         <tr>
             <th>AddlServe</th>
             <td><%= @servingguide.first.additional_serve %></td>
             <td id = "GraphAddlServe"><%= @mealplans.sum(:additional_serve) %></td>
         </tr>
     </tbody>

  </table>


<br> -->
<%= link_to 'Todays Mealplan', new_mealplan_path %>
<% end %>
<!-- <div id="container2" style="width:100%; height:400px;"></div> -->
